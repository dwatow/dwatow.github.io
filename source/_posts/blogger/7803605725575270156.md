---
title: "c++讀寫.txt檔(以每行為單位)"
date: 2014-01-27T16:46:00.000+08:00
tags: 
- "C_and_Cpp"
categories:
- 舊部落格移植文章
---

# c++讀寫.txt檔(以每行為單位)

原文連結: https://darkblack01.blogspot.com/2014/01/ctxt.html
移植時的最後更新日期: 2015-12-23T14:16:57.743+08:00

初衷：<br /><br />建立一個可以讀寫.txt檔的零件。<br />需求：<br />以每一行'\n'為單位，把vector&lt;std::string&gt;丟進去就可以得到文件文容。<br />可以讀取任意大小(至少是很大的)文件。<br />原始碼放在<a href="https://github.com/dwatow/kxString" target="_blank">Github</a>，以BSD LICENSE<br />kxTxtFile.h<br /><pre class="prettyprint"><code>#ifndef TXTFILE_H<br />#define TXTFILE_H<br />#include &lt;vector&gt;<br />#include &lt;string&gt;<br />#include &lt;fstream&gt;<br /><br />class kxTxtFile<br />{<br />    std::fstream ftxt_Std;<br />    std::vector<std::string> dtxt_Txt;<br /><br />public:<br />    bool Open(const char*);<br />    bool Save(const char*);<br /><br />    void Close(){ ftxt_Std.close(); };<br /><br />    void iTxtData(std::vector<std::string>&amp; data){ dtxt_Txt = data; mem2file(); };<br />    void oTxtData(std::vector<std::string>&amp; data){ file2mem(); data = dtxt_Txt; };<br />    std::vector<std::string> oTxtData(){ file2mem(); return dtxt_Txt; };<br /><br />private:<br />    void file2mem();<br />    void mem2file();<br />};<br />#endif</code></pre>kxTxtFile.cpp<br /><pre class="prettyprint"><code>#include "kxTxtFile.h"<br /><br />bool kxTxtFile::Open(const char* path)<br />{<br />    ftxt_Std.open (path, std::ifstream::in);<br />    return ftxt_Std.good();<br />}<br /><br />bool kxTxtFile::Save(const char* path)<br />{<br />    ftxt_Std.open (path, std::ifstream::out | std::ifstream::trunc);<br />    return ftxt_Std.good();<br />}<br /><br />void kxTxtFile::file2mem()<br />{<br />    dtxt_Txt.clear();<br />    std::string str;<br /><br />    while (getline(ftxt_Std , str))<br />        dtxt_Txt.push_back(str);<br />}<br /><br />void kxTxtFile::mem2file()<br />{<br />    if (!dtxt_Txt.empty())<br />    {<br />        for (std::vector<std::string>::iterator it = dtxt_Txt.begin(); it != dtxt_Txt.end(); ++it)<br />        {   <br />            *it += '\n';<br />            ftxt_Std.write(it-&gt;c_str(), it-&gt;length());<br />        }<br />    }<br />}</std::string></code></pre>主程式的使用情況 <pre class="prettyprint"><code>#include &lt;iostream&gt;<br />#include &lt;fstream&gt;<br />#include &lt;vector&gt;<br />#include "kxTxtFile.h"<br /><br />using namespace std;<br /><br />int main()<br />{<br />    kxTxtFile ifile;<br /><br />    if (!ifile.Open("readFilePath"))<br />        std::cout << "read error" << std::endl;<br /><br />    std::vector<string> vstr;<br />    ifile.oTxtData(vstr);<br />    ifile.Close();<br /><br />    for (std::vector<std::string>::iterator it = vstr.begin(); it != vstr.end(); ++it)<br />        std::cout << *it << std::endl;  <br /><br />    kxTxtFile ofile;<br /><br />    if (!ofile.Save("saveFilePath"))<br />        std::cout << "save error" << std::endl;<br />    <br />    ofile.iTxtData(vstr);<br /><br />    ofile.Close();<br />    return 0;<br />}</code></pre>
