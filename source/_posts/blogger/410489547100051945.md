---
title: "git 重寫歷史，使用心得"
date: 2016-12-02T11:16:00.001+08:00
tags: 
- "Git"
categories:
- 舊部落格移植文章
---

# git 重寫歷史，使用心得

原文連結: https://darkblack02.blogspot.com/2016/12/git.html
移植時的最後更新日期: 2016-12-07T11:55:38.420+08:00

這一招要小心使用。筆者使用的結果(想改兩個commiter和author, 所以掃了很多次之後)，commit出現重複的了！QQ <br /><h2><span style="font-size: x-large;">修改提交者資料</span></h2><h3><span style="font-size: large;"><br /></span></h3><h3><span style="font-size: large;">列出提交者name與mail</span></h3>下面指令是查詢目前提交者名稱與mail, 並且依提交次數排序 <br /><pre class="prettyprint"><code class="language-bash">$ git shortlog --numbered --summary --email<br /></code></pre>下面的指令是查詢目前要修改的commiter的提交內容的author和commiter是長什麼樣子<br /><pre class="prettyprint"><code class="language-bash">$ git log --pretty=format:"%an&lt;%ae&gt; - %cn&lt;%ce&gt;" --committer=error user name<br /></code></pre>下面的指令是查詢目前要修改的author的提交內容的author和commiter是長什麼樣子<br /><pre class="prettyprint"><code class="language-bash">$ git log --pretty=format:"%an&lt;%ae&gt; - %cn&lt;%ce&gt;" --author=error user name<br /></code></pre><br /><h3><span style="font-size: large;">修改歷史中提交者的name與mail</span></h3>在所有分支內<br />找出所有提交者是error@mail.com，並且改該次commit的提交者name成為right user name，email改成right@mail.com<br />找出所有作者是error@mail.com，並且改該次commit的作者name成為right user name，email改成right@mail.com <br /><pre class="prettyprint"><code class="language-bash">$ git filter-branch --commit-filter '<br />if [ "$GIT_AUTHOR_EMAIL" = "error@mail.com" ];<br />then<br />    GIT_AUTHOR_NAME="right user name";<br />    GIT_AUTHOR_EMAIL="right@mail.com";<br />    git commit-tree "$@";<br />else<br />    git commit-tree "$@";<br />fi<br /><br />if [ "$GIT_COMMITTER_EMAIL" = "error@mail.com" ];<br />then<br />    GIT_COMMITTER_NAME="right user name";<br />    GIT_COMMITTER_EMAIL="right@mail.com";<br />    git commit-tree "$@";<br />else<br />    git commit-tree "$@";<br />fi<br />' -- --all</code></pre><br /><h3><span style="font-size: large;">上傳變更</span></h3>結束之後，若你修改已push過的commit，那麼在沒有人與你一起協作的情況之下。只要使用下面的指令，即可上傳這樣的改變<br /><pre class="prettyprint"><code class="language-bash">$ git push -f --all</code></pre><br />
