---
title: C++單元測試(8) - 再用VS2005先試一下: 專案檔轉換失敗
date: 2015-05-27T15:17:00.002+08:00
tags: 
- TDD

categories:
- 舊部落格移植文章
---

# C++單元測試(8) - 再用VS2005先試一下: 專案檔轉換失敗

原文連結: https://darkblack01.blogspot.com/2015/05/c7-vs2005.html
移植時的最後更新日期: 2015-10-18T21:29:15.581+08:00

終於又再度繼續了！<br />接續<a href="http://darkblack01.blogspot.tw/search/label/TDD">上...一篇</a>，我們試著使用了VC6和VS2010編譯之後，我們這次用了VS2005編編看。<br />依之前的經驗，只要將手上的VS升級到最新的版本就可以編譯，但是會寫文章就是「事情沒這麼順利」啦~<br /><br />這一次，我們從頭來一次<br /><h2><span style="font-size: x-large;">1. 下載 source code</span></h2><a href="http://darkblack01.blogspot.tw/2014/07/cppunit.html" target="_blank">下載CppUnit</a><br />我是用clone下來的，所以...資料夾沒有版號。<br />直接就是cppunit出現在我的硬碟中。(也不用解壓縮唷)<br /><h2><span style="font-size: x-large;">2. 開啟專案檔</span></h2>打開cppunit\srcCppUnitLibraries.dsw進行專案檔的轉換<br />VS2005開啟之後，會提醒「要轉換專案檔」格式與目前的VS版本不合。<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-wfbS3lBMGOk/VWVsIK-8TyI/AAAAAAAAHqM/5pV8-uFHQzs/s1600/DSPlugIn.dsp_covert.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-wfbS3lBMGOk/VWVsIK-8TyI/AAAAAAAAHqM/5pV8-uFHQzs/s1600/DSPlugIn.dsp_covert.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">提醒「要轉換專案檔」格式與目前的VS版本不合</td></tr></tbody></table>&nbsp;按下Yes後，出現了第二個對話框，警告你是否要替代已存在的檔案。<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-yyiI2-f0d0w/VWVsILUiDTI/AAAAAAAAHqI/4TqQ5Mtovmc/s1600/DSPlugIn.dsp_covert_warning.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-yyiI2-f0d0w/VWVsILUiDTI/AAAAAAAAHqI/4TqQ5Mtovmc/s1600/DSPlugIn.dsp_covert_warning.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">警告你是否要替代已存在的檔案</td></tr></tbody></table>結果竟然給我出現錯誤！<br />程式設計師不怕警告，只怕錯誤呀！XD<br />我們來看看它寫什麼...(我把文字貼出來)<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-9_KHADX-6i0/VWVsIMUt93I/AAAAAAAAHqE/aILTxXyA-bc/s1600/ProjectLoadFailure.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-9_KHADX-6i0/VWVsIMUt93I/AAAAAAAAHqE/aILTxXyA-bc/s1600/ProjectLoadFailure.png" /></a></div><br />上圖內容如下<br />「The following error has occurred during XML parsing:<br /><br />File: D:\cppUnitTest\cppunit\src\DllPlugInTester\DllPlugInTester.vcproj<br />Line: 8<br />Column: 2<br />Error Message:<br />'9.00' 違反 '7.00 7,00 7.10 7,10 8.00 8,00' 的 'enumeration' 條件。<br />屬性 'Version' 和與值 '9.00' 的剖析失敗。<br /><br />The file 'D:\cppUnitTest\cppunit\src\DllPlugInTester\DllPlugInTester.vcproj' has failed to load.」<br />意思是，版本錯誤！<br /><br />沒關係，我們相信工具的強大！<br />按下OK之後就會出現第二個專案檔給你再一次相同的問答。<br /><br />最後，終於按完所有的Yes和OK之後，出現了....不能編譯的專案檔！？<br /><br />什麼？！&gt;&lt;<br />崩潰！( ▔皿▔) 這？說好的強大工具呢？<br /><br />好！這篇不是要抱怨Visual Studio，所以就趕快回到正題吧！<br /><br /><span style="font-size: x-large;">修改專案檔</span><br /><br />將cppunit/src底下所有的.vcproj找出來<br />總共有8個。<br /><br /><ol><li>cppunit.vcproj</li><li>cppunit_dll.vcproj</li><li>qttestrunner_dll.vcproj</li><li>TestPlugInRunner.vcproj</li><li>TestRunner.vcproj</li><li>DllPlugInTester.vcproj</li><li>DllPlugInTesterTest.vcproj</li><li>qttestrunner.vcproj</li></ol><br />全部都把它用文字編輯器打開。在此我用Sublime Text 2<br />然後，依照下列兩個原則[1]<br /><ol><li>Version="9.00"改成Version="8.00" (數字大於8.00，才改成8.00)</li><li>TargetFrameworkVersion="**" 刪除(不管數字是什麼！刪！)</li></ol><div>這樣一來，你的專案檔開啟就跟新買的一樣滑順囉~(咳！別想歪！)</div><h2><span style="font-size: x-large;">參考資料</span></h2>&nbsp;[1] VS2008工程转成VS2005工程的方法
