---
title: "C++單元測試(5) - 再用VS2010先試一下: 如何使用CppUnit"
date: 2014-09-28T20:58:00.002+08:00
tags: 
- "TDD"
categories:
- 舊部落格移植文章
---

# C++單元測試(5) - 再用VS2010先試一下: 如何使用CppUnit

原文連結: https://darkblack01.blogspot.com/2014/09/c4-vs2010-cppunit.html
移植時的最後更新日期: 2015-10-18T21:28:29.895+08:00

終於繼續了！<br />接續<a href="http://darkblack01.blogspot.tw/2014/08/c2-cppunit.html" target="_blank">上一篇</a>，我們試著使用了VC6編譯之後，我們這次用了cppUnit官方建議VS版本第二個 - VS2010。<br /><br />如同VC6那篇一樣，先介紹成功案例的整個專案的規劃與設定吧！<br /><h2><span style="font-size: x-large;">專案檔與檔案之間的設定</span></h2>一樣UnitTest是獨立在開發專案外的另一個專案。<br />(此專案是由空專案開始，加上.cpp和.h)<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-SfEZ0-0odbk/VCgDnTpuyUI/AAAAAAAAHes/tPZmJyU-jFA/s1600/proj.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-SfEZ0-0odbk/VCgDnTpuyUI/AAAAAAAAHes/tPZmJyU-jFA/s1600/proj.png" /></a></div><h2><span style="font-size: x-large;">程式碼</span></h2>接下來的程式碼與<a href="http://darkblack01.blogspot.tw/search/label/TDD">前一篇</a>相同，在此就不綴述。<br />(一模一樣唷！)<br /><h2><span style="font-size: x-large;">設定專案檔屬性</span></h2>最後，設定專案檔，如何使用CppUnit的檔案。<br />因為與VC6的介面大不同，而且從VS2003(有這一版嗎？)之後幾乎就是長這樣(只有些許的不同)，在此講一下，適用滿多版本的。<br /><br />在UnitTest專案檔上按右鍵→屬性<br />出現專案屬性設定頁面，在此可以點選上一層視窗的專案檔，設定值會跟著載入唷！<br />所以，看見這個頁面時請確認你的專案檔是否有點在UnitTest的專案上。<br /><h3><span style="font-size: large;">.h檔路徑</span></h3><span style="font-size: small;">先設定要#include 的.h檔路徑</span><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-hsiH7hDboyY/VCgDnWEK-nI/AAAAAAAAHek/OrVUyhCAS7A/s1600/cppunti_vs2010_include_file.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-hsiH7hDboyY/VCgDnWEK-nI/AAAAAAAAHek/OrVUyhCAS7A/s1600/cppunti_vs2010_include_file.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">在「其他 Include 目錄」中填上.h檔路徑</td></tr></tbody></table><h3><span style="font-size: large;">lib檔的路徑</span></h3>再設定link時期要找得到的lib檔的路徑<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-JaLsv6LTgXA/VCgDmffE3qI/AAAAAAAAHeY/Ysjj4jjz0es/s1600/cppunit_vs2010_linkfile_path.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-JaLsv6LTgXA/VCgDmffE3qI/AAAAAAAAHeY/Ysjj4jjz0es/s1600/cppunit_vs2010_linkfile_path.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">在「其它程式庫目錄」中填入.lib的路徑</td></tr></tbody></table><h3><span style="font-size: large;">lib檔的檔案名稱</span></h3>再設定link時期要找得到的lib檔的檔案名稱<br />在此要注意，這一版的VS要用分號隔開唷！VS2005好像就是用空白隔開...<br />(不確定的話，可以靠tool設定，它會自動幫你加)<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-s7jpR_AhlBs/VCgDmV7juBI/AAAAAAAAHeQ/msTvKFtLY4g/s1600/cppunit_vs2010_linkfile_files.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-s7jpR_AhlBs/VCgDmV7juBI/AAAAAAAAHeQ/msTvKFtLY4g/s1600/cppunit_vs2010_linkfile_files.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">在「其他相依性」中填入.lib檔的檔名(這個就不知道翻譯<strike>的在幹</strike>什麼<strike>吃的</strike>了)</td></tr></tbody></table><h3><span style="font-size: large;">執行</span></h3>設定UnitTest為Active Project就可以「以Unit Test為主」<br />在IDE按下編譯→執行，就可以看見Unit Test的執行結果報告了！^^<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-BEcxB7Znd5c/VCgDmfTd9WI/AAAAAAAAHeU/O_4PuMfy_NM/s1600/cppunit_vs2010_run.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-BEcxB7Znd5c/VCgDmfTd9WI/AAAAAAAAHeU/O_4PuMfy_NM/s1600/cppunit_vs2010_run.png" /></a></div><br /><br /><h2><span style="font-size: x-large;">可能會遇到的問題</span></h2>接下來，我們來聊一下一些途中可能會遇到的問題。<br />這也是為什麼這次拖這麼久才貼這一篇，是有原因的！<br /><br />如果只是灌好VS2010直接編譯，編譯出這三個項目，會....算是滿順利的了。<br />cppunit.lib<br />cppunitd.lib<br />cppunit_dll.lib<br /><br />頂多出現<b>warning C4251</b><br />不過，官方有說這個不用理它也可以。(實驗之後發現，真的可以耶！)<br /><br /><b>error LNK1123</b><br />再之後就會開始卡關，出現問題。<br /><blockquote class="tr_bq">LINK : fatal error LNK1123: 轉換成 COFF 時失敗: 檔案無效或損毀</blockquote>這個問題，查了一下<br /><a href="http://stackoverflow.com/questions/10888391/error-link-fatal-error-lnk1123-failure-during-conversion-to-coff-file-inval" target="_blank">http://stackoverflow.com/questions/10888391/error-link-fatal-error-lnk1123-failure-during-conversion-to-coff-file-inval</a><br /><br /><span style="color: #cc0000;">發現，建議灌sp1！</span><br /><strike>vs2010還有sp1唷？微軟是不是什麼都要來個sp1呀？那以後微軟的東西都不用太早買了。(本來就...)</strike><br />之後就一路順利的編譯到底！<br /><br /><br />另外，關於這個部份，竟然還有教學影片耶！有興趣的朋友，就跟著它一步一步做吧！(我還是建議升級到sp1唷)<br /><iframe allowfullscreen="" frameborder="0" height="315" src="//www.youtube.com/embed/C4k4hxAjp54" width="560"></iframe>
