---
title: 關於物件的「==」運算子與提昇UX。
date: 2014-03-07T11:43:00.001+08:00
tags: 
- C_and_Cpp

categories:
- 舊部落格移植文章
---

# 關於物件的「==」運算子與提昇UX。

原文連結: https://darkblack01.blogspot.com/2014/03/ux.html
移植時的最後更新日期: 2015-12-23T14:16:57.611+08:00

這不是要教你怎麼覆寫==運算子，讓物件的==得到適當的定義。<br />而是要教你，如何告訴使用者，哪一個沒有比對結果。<br /><br />示範準備程式碼<br /><pre class="prettyprint"><code>#include &lt;vector&gt;<br />#include &lt;iterator&gt;<br />#include &lt;iostream&gt;<br /><br />class tObj<br />{<br />    int m_condition[3];<br />public:<br />    void setCondition(const int&amp; Value1, const int&amp; Value2, const int&amp; Value3)<br />    {<br />        m_condition[0] = Value1;<br />        m_condition[1] = Value2;<br />        m_condition[2] = Value3;<br />    }<br />    const int getCondition(int index) const<br />    {<br />        return m_condition[index];<br />    }<br />    bool operator==(const tObj&amp; obj) const<br />    {<br />        if ( (m_condition[0] == obj.m_condition[0]) &amp;&amp; <br />             (m_condition[1] == obj.m_condition[1]) &amp;&amp; <br />             (m_condition[2] == obj.m_condition[2]) )<br />            return true;<br />        else<br />            return false;<br />    }<br />};<br /><br />void InitDB(tObj* o)<br />{<br />    (o+0)-&gt;setCondition(4, 6, 8);<br />    (o+1)-&gt;setCondition(2, 6, 6);<br />    (o+2)-&gt;setCondition(2, 6, 6);<br />    (o+3)-&gt;setCondition(2, 6, 8);<br />    (o+4)-&gt;setCondition(2, 4, 8);<br />    (o+5)-&gt;setCondition(2, 4, 8);<br />    (o+6)-&gt;setCondition(2, 4, 8);<br />    (o+7)-&gt;setCondition(2, 4, 8);<br />    (o+8)-&gt;setCondition(2, 4, 8);<br />    (o+9)-&gt;setCondition(2, 4, 8);<br />}<br /><br />void DBtoVector(tObj* o, std::vector&lt;tObj&gt;&amp; vo)<br />{<br />    for (int i = 0; i &lt; 10; ++i)<br />        vo.push_back(*(o+i));<br />}<br /><br />void displayMatch(std::vector&lt;tObj&gt; const&amp; matchSample)<br />{<br />    for (std::vector&lt;tObj&gt;::const_iterator ims  = matchSample.begin();<br />                                           ims != matchSample.end(); ++ims)<br />        std::cout &lt;&lt; ims-&gt;getCondition(0) &lt;&lt; ", " <br />                  &lt;&lt; ims-&gt;getCondition(1) &lt;&lt; ", " <br />                  &lt;&lt; ims-&gt;getCondition(2) &lt;&lt; ", " &lt;&lt; std::endl;<br />}<br /><br />void isMatch(const tObj&amp; x, std::vector&lt;tObj&gt;&amp; vo)<br />{<br />    std::vector&lt;tObj&gt; matchSample;<br />    for (std::vector&lt;tObj&gt;::iterator it = vo.begin(); it != vo.end(); ++it)<br />        if (*it == x)  matchSample.push_back(*it);<br />    vo.clear();<br />    vo = matchSample;<br />}<br /><br />int main(int argc, char const *argv[])<br />{<br />    tObj o[10];           InitDB(o);<br />    std::vector&lt;tObj&gt; vo; DBtoVector(o, vo);<br />    tObj x;               x.setCondition(2, 4, 8);  //sample<br /><br />    isMatch(x, vo);    <br />    displayMatch(vo);<br /><br />    return 0;<br />}</code></pre><br />一開始，C++的書都會教我們，比對資料這件事覆寫operator==()然後，用vector + iterator +&nbsp;for就可以找出來想要的了！。<br />但是，為了使用者！你必須告訴他，如果比對資料輸入錯誤，那麼，又該怎麼寫，才可以告訴使用者「你的第幾個值寫錯了」呢？<br /><br />第一件事，就是刪掉operator==()先。真的！<br /><br />新增這一段程式碼<br /><pre class="prettyprint"><code>const bool partsMatch(const int&amp; index, std::vector&lt;tObj&gt;&amp; vo, const tObj&amp; x)<br />{<br />    std::vector&lt;tObj&gt; matchSample;<br />    for (std::vector&lt;tObj&gt;::iterator it = vo.begin(); it != vo.end(); ++it)<br />        if (it-&gt;getCondition(index) == x.getCondition(index))<br />            matchSample.push_back(*it);<br /><br />    vo.clear();<br />    vo = matchSample;<br />    return (matchSample.size()) ? true : false;<br />}</code></pre>修改這一段程式碼，將回傳值改成字串<br /><pre class="prettyprint"><code>std::string isMatch(const tObj&amp; x, std::vector&lt;tObj&gt;&amp; vo)<br />{<br />    if (!partsMatch(0, vo, x))<br />        return "條件1 無符合項目";<br />    else if (!partsMatch(1, vo, x))<br />        return "條件2 無符合項目";<br />    else if (!partsMatch(2, vo, x))<br />        return "條件3 無符合項目";<br />    else<br />        return "完全符合";<br />}</code></pre>主程式修改一下<br /><pre class="prettyprint"><code>int main(int argc, char const *argv[])<br />{<br />    tObj o[10];           InitDB(o);<br />    std::vector&lt;tObj&gt; vo; DBtoVector(o, vo);<br />    tObj x;               x.setCondition(2, 6, 1);  //sample<br /><br />    std::cout &lt;&lt; isMatch(x, vo) &lt;&lt; std::endl;<br />    displayMatch(vo);<br /><br />    return 0;<br />}</code></pre>最後變成這樣(全部的程式碼)<br /><pre class="prettyprint"><code>#include &lt;vector&gt;<br />#include &lt;iterator&gt;<br />#include &lt;iostream&gt;<br />#include &lt;string&gt;<br /><br />class tObj<br />{<br />    int m_condition[3];<br />public:<br />    void setCondition(const int&amp; Value1, const int&amp; Value2, const int&amp; Value3)<br />    {<br />        m_condition[0] = Value1;<br />        m_condition[1] = Value2;<br />        m_condition[2] = Value3;<br />    }<br />    const int getCondition(int index) const<br />    {<br />        return m_condition[index];<br />    }<br />};<br /><br />void InitDB(tObj* o)<br />{<br />    (o+0)-&gt;setCondition(4, 6, 8);<br />    (o+1)-&gt;setCondition(2, 6, 6);<br />    (o+2)-&gt;setCondition(2, 6, 6);<br />    (o+3)-&gt;setCondition(2, 6, 8);<br />    (o+4)-&gt;setCondition(2, 4, 8);<br />    (o+5)-&gt;setCondition(2, 4, 8);<br />    (o+6)-&gt;setCondition(2, 4, 8);<br />    (o+7)-&gt;setCondition(2, 4, 8);<br />    (o+8)-&gt;setCondition(2, 4, 8);<br />    (o+9)-&gt;setCondition(2, 4, 8);<br />}<br /><br />void DBtoVector(tObj* o, std::vector&lt;tObj&gt;&amp; vo)<br />{<br />    for (int i = 0; i &lt; 10; ++i)<br />        vo.push_back(*(o+i));<br />}<br /><br />void displayMatch(std::vector&lt;tObj&gt; const&amp; matchSample)<br />{<br />    for (std::vector&lt;tObj&gt;::const_iterator ims  = matchSample.begin();<br />                                           ims != matchSample.end(); ++ims)<br />        std::cout &lt;&lt; ims-&gt;getCondition(0) &lt;&lt; ", " <br />                  &lt;&lt; ims-&gt;getCondition(1) &lt;&lt; ", " <br />                  &lt;&lt; ims-&gt;getCondition(2) &lt;&lt; ", " &lt;&lt; std::endl;<br />}<br /><br />const bool partsMatch(const int&amp; index, std::vector&lt;tObj&gt;&amp; vo, const tObj&amp; x)<br />{<br />    std::vector&lt;tObj&gt; matchSample;<br />    for (std::vector&lt;tObj&gt;::iterator it = vo.begin(); it != vo.end(); ++it)<br />        if (it-&gt;getCondition(index) == x.getCondition(index))<br />            matchSample.push_back(*it);<br /><br />    vo.clear();<br />    vo = matchSample;<br />    return (matchSample.size()) ? true : false;<br />}<br /><br />std::string isMatch(const tObj&amp; x, std::vector&lt;tObj&gt;&amp; vo)<br />{<br />    if (!partsMatch(0, vo, x))<br />        return "條件1 無符合項目";<br />    else if (!partsMatch(1, vo, x))<br />        return "條件2 無符合項目";<br />    else if (!partsMatch(2, vo, x))<br />        return "條件3 無符合項目";<br />    else<br />        return "完全符合";<br />}<br /><br />int main(int argc, char const *argv[])<br />{<br />    tObj o[10];           InitDB(o);<br />    std::vector&lt;tObj&gt; vo; DBtoVector(o, vo);<br />    tObj x;               x.setCondition(2, 6, 1);  //sample<br /><br />    std::cout &lt;&lt; isMatch(x, vo) &lt;&lt; std::endl;<br />    displayMatch(vo);<br /><br />    return 0;<br />}</code></pre>也許不是完全美的做法，但是，還不賴。
