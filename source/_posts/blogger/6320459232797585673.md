---
title: "抓現在目錄之GetModuleFileName()&GetCurrentDirectory()"
date: 2012-08-13T15:15:00.002+08:00
tags: 
- "WIN32 API/MFC"
categories:
- 舊部落格移植文章
---

# 抓現在目錄之GetModuleFileName()&GetCurrentDirectory()

原文連結: https://darkblack01.blogspot.com/2012/08/getmodulefilename.html
移植時的最後更新日期: 2012-09-24T18:36:43.950+08:00

執行檔在&nbsp;D:\Software\App1\SelXls\Debug\SelXls.exe<br /><br />抓執行檔所在目錄+檔名.exe（因為是執行檔）<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>GetModuleFileName(NULL, strFilePath.GetBuffer(MAX_PATH+1), MAX_PATH); &nbsp;<span style="color: #999999;">//抓應用程式所在的目錄+檔名+副檔名</span><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>strFilePath.ReleaseBuffer(); &nbsp; <span style="color: #cc0000;">//要加這一行，才可以處理該字串</span><br /><span style="color: #6fa8dc;">// &nbsp; &nbsp; &nbsp;strFilePath = D:\Software\App1\SelXls\Debug\SelXls.exe</span><br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;strFilePath =&nbsp;strFilePath.Left(strFilePath.ReverseFind('\\')); &nbsp; &nbsp;<span style="color: #6fa8dc;">//</span><span style="color: #6fa8dc;">= <b>D:\Software\App1\SelXls\Debug</b></span><br /><div><br /></div><div>抓目前所在目錄（會依開啓舊檔而改變）</div><div><div><span class="Apple-tab-span" style="white-space: pre;"> </span>GetCurrentDirectory(MAX_PATH, strFilePath.GetBuffer(0)); &nbsp;//抓目前所在的目錄（路徑）</div><div><span style="color: #6fa8dc;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //</span><span style="color: #6fa8dc;">&nbsp;</span><span style="color: #6fa8dc;">&nbsp; &nbsp; &nbsp;strFilePath =</span><span style="color: #6fa8dc;">&nbsp;</span><span style="color: #6fa8dc;"><b>D:\Software\App1\SelXls\Debug</b></span></div></div><div><br /></div><br />
