---
title: RawReader by MFC
date: 2012-01-20T16:24:00.000+08:00
tags: 
- 設計
,- WIN32 API/MFC

categories:
- 舊部落格移植文章
---

# RawReader by MFC

原文連結: https://darkblack01.blogspot.com/2012/01/rawreader-by-mfc.html
移植時的最後更新日期: 2012-01-30T08:16:11.670+08:00

<div class="separator" style="clear: both; text-align: left;">突然想寫個RawReader讀取*.raw檔</div><div class="separator" style="clear: both; text-align: left;">就來用學很久的MFC寫一個，完成研究所原本想做的事吧？！</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><span style="font-family: inherit; margin-left: 1em; margin-right: 1em;"><a href="http://2.bp.blogspot.com/-tLV_gCL04qE/TxkjBT51iTI/AAAAAAAABzc/jWwh0wGnpnk/s1600/RawRead.bmp" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="316" src="http://2.bp.blogspot.com/-tLV_gCL04qE/TxkjBT51iTI/AAAAAAAABzc/jWwh0wGnpnk/s320/RawRead.bmp" width="320" /></a></span></div><span style="font-family: inherit;"><br /></span><br /><span style="font-family: inherit;">用VC++6建立一個Single Document</span><br /><span style="font-family: inherit;"></span><br /><a name='more'></a><span style="font-family: inherit;"><br /></span><br /><span style="font-family: inherit;">在</span>CRAWReaderView&nbsp;的class<span style="font-family: inherit;">中宣告</span><br /><br /><span class="Apple-tab-span" style="white-space: pre;"> </span>CStdioFile RawFile;<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>unsigned char RawBuf[276][235][3];<br /><div style="font-family: inherit;"><br /></div><div style="font-family: inherit;">並且在下面的位置加入程式碼</div><br /><span style="font-family: inherit;"><br /></span><br /><br /><span style="font-family: inherit;">void CRAWReaderView::OnDraw(CDC* pDC)</span><br /><span style="font-family: inherit;">{</span><br /><span style="color: #cccccc; font-family: inherit;">&nbsp; &nbsp; CRAWReaderDoc* pDoc = GetDocument();</span><br /><span style="color: #cccccc; font-family: inherit;">&nbsp; &nbsp; ASSERT_VALID(pDoc);</span><br /><span style="color: #6aa84f; font-family: inherit;">&nbsp; &nbsp; // TODO: add draw code for native data here</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; CString FilePath;</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; FilePath.Format("276x3x235.raw");</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; if (!RawFile.Open(FilePath, CFile::modeRead | CFile::typeBinary))</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; AfxMessageBox("檔案開啟失敗");</span><br /><span style="font-family: inherit;">&nbsp; &nbsp;&nbsp;</span><br /><span style="font-family: inherit;"><span style="font-family: inherit;">&nbsp; &nbsp; for (int pY = 0; pY</span>&lt;235 ; ++pY)</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; for (int pX = 0; pX&lt;276 ; ++pX)</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; for (int k &nbsp;= 0; &nbsp;k&lt;3 &nbsp; ; ++k)</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; RawBuf[pY][pX][k] = 0;</span><br /><span style="font-family: inherit;"><br /></span><br /><span style="font-family: inherit;">&nbsp; &nbsp; if (!RawFile.Read(RawBuf, 276*235*3))</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; AfxMessageBox("讀檔失敗");</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; RawFile.Close();</span><br /><span style="font-family: inherit;"><br /></span><br /><span style="font-family: inherit;">&nbsp; &nbsp; for (pY = 0; pY &lt; 235 ; ++pY)</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; for (pX = 0; pX &lt; 276<span style="color: red;"> + pY * 41</span> ; ++pX)</span><br /><span style="font-family: inherit;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pDC-&gt;SetPixelV((pX<span style="color: red;"> - pY * 41</span>), pY, RGB(RawBuf[pY][pX][0], RawBuf[pY][pX][1], RawBuf[pY][pX][2]));</span><br /><span style="font-family: inherit;">}</span><br /><span style="font-family: inherit;"><br /></span><br /><span style="font-family: inherit;">這個程式還沒有很好，因為紅色字的部份算是不正常的部份！</span><br /><span style="font-family: inherit;">不知道code裡面有沒有什麼bug</span><br /><span style="font-family: inherit;"><br /></span><br /><span style="font-family: inherit;"><br /></span><br /><span style="font-family: inherit;">找到了！</span><br /><br />--<br />※ 發信站: 批踢踢實業坊(ptt.cc)<br />◆ From: 59.120.98.237<br />→ zetab:RawBuf的index超過你宣告的範圍了 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 01/20 19:08<br /><div style="font-family: inherit;"><br /></div><div style="font-family: inherit;"><span class="Apple-tab-span" style="white-space: pre;"> </span>unsigned char RawBuf[276][235][3]; </div><div style="font-family: inherit;">變成</div><div style="font-family: inherit;"><span class="Apple-tab-span" style="white-space: pre;"> </span>unsigned char RawBuf[235]<span style="font-family: inherit;">[276][3];</span></div><div style="font-family: inherit;"><span style="font-family: inherit;">就好了...</span></div><div style="font-family: inherit;"><span style="font-family: inherit;">等等來試.....</span></div>
