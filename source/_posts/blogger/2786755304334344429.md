---
title:  C++單元測試(3) - 測試VS2005的C++專案
date: 2014-08-07T10:25:00.002+08:00
tags: 
- TDD
,- C_and_Cpp

categories:
- 舊部落格移植文章
---

#  C++單元測試(3) - 測試VS2005的C++專案

原文連結: https://darkblack01.blogspot.com/2014/08/c3-vs2005c.html
移植時的最後更新日期: 2015-12-26T14:17:50.460+08:00

續<a href="http://darkblack01.blogspot.tw/2014/08/c2-cppunit.html">前一篇</a>取得的聖杯。<br /><br />接下來的困難點，卻是VS2005的專案檔設定。<br /><br />這一次的環境是使用Windows 8.1, VS2005 SP2<br /><a href="http://darkblack01.blogspot.tw/2015/05/c7-vs2005.html" target="_blank">CppUnit要修改專案檔</a>。<br /><br />不過！要知道取出哪一個部份<br /><br /><h2><span style="font-size: x-large;">第一步 取得正確的檔案</span></h2>要知道我們在上一篇編譯結束後，出現的cppunit.lib 和 cppunit_dll.lib要如何正確使用。<br />除了擁有link時期需要的.lib檔之外，還要取得complier時期需要的.h檔(也就是include會用到的部份)。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-18pcUQNTX_w/U-EDSQJIWwI/AAAAAAAAHY8/o90DtQb1Cjc/s1600/pathCppUnit.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="434" src="http://1.bp.blogspot.com/-18pcUQNTX_w/U-EDSQJIWwI/AAAAAAAAHY8/o90DtQb1Cjc/s1600/pathCppUnit.png" width="640" /></a></div><br />.lib檔位於cppunit1.13.2/lib/裡面。<br />.h檔位於cppunit1.13.2/include/裡面。(通常會編出Debug和Release兩種)<br /><br />不過，我沒有試過直接拿CppUnit的原始碼加到專案檔裡，這招應該是沒有問題的。<br />下次來試試看。<br /><br /><h2><span style="font-size: x-large;">第二步，開啟你要做單元測試的專案</span></h2>在此就是使用VS2005啦。<br />其實，難還是難在專案檔的設定，因為沒有任何書針對這部份詳細解說(入門書都簡單講一下，深入的書都不提這個區塊，MSDN....你懂的！)<br /><br />在此，我們使用的專案名稱為「xCppUnit」<br />並且把cppUnit的檔案另外放在D:\sandbox\cppunitlib (不放在上圖的目錄中)<br />分別是<br />cppunitlib\include\cppunit\extensions<br />cppunitlib\include\cppunit<br />cppunitlib\include<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-1CN_g4a68Co/U-LPSsCp2nI/AAAAAAAAHZQ/UQL1ehi3Y9k/s1600/Include_h_file.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="445" src="http://1.bp.blogspot.com/-1CN_g4a68Co/U-LPSsCp2nI/AAAAAAAAHZQ/UQL1ehi3Y9k/s1600/Include_h_file.png" width="640" /></a></div>在專案設定裡找到這個地方，並填上.h檔的路徑(記得用;隔開<strike>，設定不包含子目錄吧？</strike>)<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-LVqoZtnCOR0/U-LQzSOcjYI/AAAAAAAAHZc/6QD8ZguoH6Y/s1600/add_lib_file.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="444" src="http://4.bp.blogspot.com/-LVqoZtnCOR0/U-LQzSOcjYI/AAAAAAAAHZc/6QD8ZguoH6Y/s1600/add_lib_file.png" width="640" /></a></div>在專案設定裡找到這個地方，並填上.lib檔的路徑(記得用;隔開)<br /><br /><h2><span style="font-size: x-large;">第三步 貼上練習的code，Build it!!</span></h2>接下來就完事了。<br />可以開始<strike>寫測試案例了</strike><a href="http://download.51testing.com/ddimg/uploadsoft/20100414/CppUnitCookBook.pdf">貼上練習的測試案例</a>測試看看囉！[1]<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-sMNdNf0_4D8/U-LRrIUR5UI/AAAAAAAAHZk/PxU98ikYHc4/s1600/Build_OK.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="496" src="http://2.bp.blogspot.com/-sMNdNf0_4D8/U-LRrIUR5UI/AAAAAAAAHZk/PxU98ikYHc4/s1600/Build_OK.png" width="640" /></a></div>只有一個main檔。沒有加上其它的code。貼上測試案例，加上足夠的include檔案。即可編譯成功。<br /><br />這系列到目前，是我遇到網路上找不到資料的步驟，也許太簡單所以高手寫文章都直接跳過這些，對於我們這種新手要踏進來，對於太多不懂的。所以，就將自己研究的過程寫下來，並且仔細的告訴你，怎麼做，祝大家順利啦！^^。<br /><br /><h2><span style="font-size: x-large;">另外，有一個延伸閱讀。</span></h2>在<a href="http://darkblack01.blogspot.tw/2014/07/cppunit.html">第一篇</a>的時候，我們找到了維基百科對CppUnit的參考資料<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-KHAPf3sUdHc/U9NFkFj9d2I/AAAAAAAAHXg/AiFxad2k1eQ/s1600/wiki_references.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="164" src="http://1.bp.blogspot.com/-KHAPf3sUdHc/U9NFkFj9d2I/AAAAAAAAHXg/AiFxad2k1eQ/s1600/wiki_references.png" width="640" /></a></div>上面有一個Further reading，這是一本教你寫遊戲的書唷！^^<br />Ch1.7有介紹CppUnit的使用方式，有興趣的人可以把它<a href="http://pan.baidu.com/share/link?shareid=1797423902&amp;uk=3694234608">找出來</a>。[2]<br /><br /><br />參考資料：<br />[1]&nbsp;<a href="http://download.51testing.com/ddimg/uploadsoft/20100414/CppUnitCookBook.pdf">CppUnit CookBook 中文版</a><br />[2]&nbsp;<a href="http://pan.baidu.com/share/link?shareid=1797423902&amp;uk=3694234608" target="_blank">游戏编程精粹6</a>
