---
title: CFileDialog
date: 2012-05-11T09:05:00.001+08:00
tags: 
- WIN32 API/MFC

categories:
- 舊部落格移植文章
---

# CFileDialog

原文連結: https://darkblack01.blogspot.com/2012/05/cfiledialog.html
移植時的最後更新日期: 2012-08-14T09:30:04.261+08:00

CFileDialog fileDlg (<br /><span class="Apple-tab-span" style="white-space: pre;">  </span> &nbsp; TRUE,<span class="Apple-tab-span" style="white-space: pre;">                                </span><span style="color: #999999;">//bOpenFileDialog<span class="Apple-tab-span" style="white-space: pre;"> </span>設置為 TRUE：開啟舊檔；</span><br /><span style="color: #999999;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FALSE另存新檔</span><br /><span class="Apple-tab-span" style="white-space: pre;">  </span> &nbsp; "txt",<span class="Apple-tab-span" style="white-space: pre;">                                 </span><span style="color: #999999;">//lpszDefExt<span class="Apple-tab-span" style="white-space: pre;">  </span>檔案類型的內容</span><br /><span class="Apple-tab-span" style="white-space: pre;">  </span> &nbsp; "*.txt",<span class="Apple-tab-span" style="white-space: pre;">                              </span><span style="color: #999999;">//lpszFileName<span class="Apple-tab-span" style="white-space: pre;">  </span>檔案名稱</span><br /><span class="Apple-tab-span" style="white-space: pre;">  </span> &nbsp;OFN_ALLOWMULTISELECT,<span class="Apple-tab-span" style="white-space: pre;">     </span><span style="color: #999999;">//dwFlags</span><br /><span class="Apple-tab-span" style="white-space: pre;">  </span> &nbsp;szFilters,<span class="Apple-tab-span" style="white-space: pre;">                             </span><span style="color: #999999;">//szFilters &nbsp; &nbsp; &nbsp; &nbsp; 瀏覽過濾器</span><br /><span class="Apple-tab-span" style="white-space: pre;">  </span> &nbsp;this<span class="Apple-tab-span" style="white-space: pre;">                                    </span><span style="color: #999999;">//pParentWnd &nbsp; &nbsp; &nbsp; &nbsp;父視窗指標</span><br /><span class="Apple-tab-span" style="white-space: pre;">                                             </span><span style="color: #999999;">//dwSize &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;預設0：依作業系統預設類型</span><br /><span class="Apple-tab-span" style="white-space: pre;">  </span> &nbsp;);<br /><br /><b><span style="font-size: large;">Sample Code:</span></b><br /><br /><br /><br />void CColorEyeIDoc::OnFileOpen()<br />{<br />&nbsp; &nbsp; CFileDialog aFileDialog (TRUE, NULL, NULL, OFN_SHAREAWARE | OFN_OVERWRITEPROMPT, m_strFilter);<br />&nbsp; &nbsp;<br />&nbsp; &nbsp; int nID = aFileDialog.DoModal();<br />&nbsp; &nbsp; if (nID == IDOK)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; f_Omd-&gt;SetMsrData(vChain1);<br />&nbsp; &nbsp; &nbsp; &nbsp; if(f_Omd-&gt;Open(aFileDialog.GetPathName()))<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SetPathName(aFileDialog.GetPathName());<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SetTitle(aFileDialog.GetFileName());<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; UpdateAllViews(NULL);<br />}<br /><br /><br /><br />void CColorEyeIDoc::OnFileSaveAs()<br />{<br /><br />&nbsp; &nbsp; CFileDialog fSaveDlg (FALSE, <span style="color: #3d85c6;">"omd"</span>, "*.omd", OFN_SHAREAWARE, m_strFilter); &nbsp;<span style="color: #3d85c6;">//存檔會自己加副檔名</span><br /><br />&nbsp; &nbsp; int nID = fSaveDlg.DoModal();<br />&nbsp; &nbsp; if (nID == IDOK)<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; f_Omd-&gt;SetMsrData(vChain1);<br />&nbsp; &nbsp; &nbsp; &nbsp; if (f_Omd-&gt;Save(fSaveDlg.GetPathName()))<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SetTitle(fSaveDlg.GetFileName());<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SetPathName(fSaveDlg.GetPathName());<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; DebugByTxt();<br />}<br />
