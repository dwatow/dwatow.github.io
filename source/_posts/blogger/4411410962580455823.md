---
title: CString中找關鍵字的技巧
date: 2013-04-25T09:45:00.000+08:00
tags: 
- WIN32 API/MFC

categories:
- 舊部落格移植文章
---

# CString中找關鍵字的技巧

原文連結: https://darkblack01.blogspot.com/2013/04/mfc.html
移植時的最後更新日期: 2015-06-08T09:17:33.507+08:00

我們常常要在字串截取一段之後，尋找想要的一邊、一段、一個字。<br />在此，將使用MFC的CString做示範。(因為這個我最常用！XD）<br /><br /><br /><h2><span style="font-size: x-large;">CString技法</span></h2><h3><span style="font-size: large;">abcdefghijklmnopqrstuvwxyz<br />字串搜尋</span></h3><a name='more'></a><br /><ul><li><h3><span style="font-size: large;">Find()函數</span></h3></li><pre class="prettyprint"><code>CString sample = “abcdefghijklmnopqrstuvwxyz”;<br />const CString goal(“fg”);<br />int goalIndex = sample.Find(goal);</code></pre><span style="font-family: Courier New, Courier, monospace;">&nbsp;abcde<span style="color: blue;">fg</span>hijk…<br />01234<span style="color: blue;">5</span>6789…</span><br /><br /><li><h3><span style="font-size: large;">找fg左全部</span></h3></li><pre class="prettyprint"><code>CString sample = “abcdefghijklmnopqrstuvwxyz”;<br />const CString goal(“fg”);<br />int goalIndex = sample.Find(goal);<br /><br />CString result = sample.Left(goalIndex);</code></pre><span style="font-family: Courier New, Courier, monospace;">&nbsp;<span style="background-color: #ffe599;">abcde</span><span style="color: blue;">fg</span>hijk…<br />01234<span style="color: blue;">5</span>6789…</span><br /><br /><li><h3><span style="font-size: large;">找fg左3位</span></h3></li><pre class="prettyprint"><code>CString sample = “abcdefghijklmnopqrstuvwxyz”;<br />const CString goal(“fg”);<br />int goalIndex = sample.Find(goal);<br />const int charAmount = 3;<br />CString result = sample.Mid(goalIndex-charAmount, charAmount);</code></pre><span style="font-family: Courier New, Courier, monospace;">&nbsp;ab<span style="background-color: #ffe599;">cde</span><span style="color: blue;">fg</span>hijk…<br />01234<span style="color: blue;">5</span>6789…</span><br /><br /><li><h3><span style="font-size: large;">取出特定字之間的字</span></h3></li><pre class="prettyprint">CString sample = “abcdefghijklmnopqrstuvwxyz”;<br />const CString begin(“bc”), end(“fg”);<br />int beginIndex = sample.Find(begin);<br />int endIndex   = sample.Find(end);<br />CString result<br />    = sample.Mid(beginIndex+begin.GetLength(), <br />        endIndex-beginIndex-begin.GetLength()); //感謝網友jordan5441更正</pre><span style="font-family: Courier New, Courier, monospace;">&nbsp;a<span style="color: blue;">bc</span><span style="background-color: #ffe599;">de</span><span style="color: blue;">fg</span>hijk…<br />0<span style="color: blue;">1</span>234<span style="color: blue;">5</span>6789…</span><br /><br /><li><h3><span style="font-size: large;">找fg右全部</span></h3></li><pre class="prettyprint"><code>CString sample = “abcdefghijklmnopqrstuvwxyz”;<br />const CString goal(“fg”);<br />int goalIndex = sample.Find(goal);<br /><br />CString result <br />  = sample.Right( sample.GetLength() -  goalIndex+goal.GetLength() );<br /></code></pre><span style="font-family: Courier New, Courier, monospace;">&nbsp;abcde<span style="color: blue;">fg</span><span style="background-color: #ffe599;">hijk…</span><br />01234<span style="color: blue;">5</span>6789…</span><br /><br /><li><h3><span style="font-size: large;">找fg右3位</span></h3></li><pre class="prettyprint"><code>CString sample = “abcdefghijklmnopqrstuvwxyz”;<br />const CString goal(“fg”);<br />int goalIndex = sample.Find(goal);<br />const int charAmount = 3;<br />CString result = sample.Mid(abcIndex+goalIndex.GetLength(), charAmount);</code></pre><span style="font-family: Courier New, Courier, monospace;">&nbsp;abcde<span style="color: blue;">fg</span><span style="background-color: #ffe599;">hij</span>k…<br />01234<span style="color: blue;">5</span>6789…</span><br /><br /><li><h3><span style="font-size: large;">Find()注意事項</span></h3></li><pre class="prettyprint"><code>CString sample = “abcdefghijklmnopqrstuvwxyz”;<br />int errorIndex = sample.Find(“llllll”);<br />int emptyIndex = sample.Find(“”);</code></pre>errorIndex: -1<br /> emptyIndex: 0<br /><br />搜尋空字串和找不到是兩件事。<br />也就是關鍵字搜尋(假設「找某關鍵字」為true)<br />「找某關鍵字or空字串」→true<br />「找某關鍵字and找不到」→false<br /></ul>
