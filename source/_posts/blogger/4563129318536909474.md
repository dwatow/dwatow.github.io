---
title: MFC用在Excel（載入Class篇）
date: 2010-11-19T09:18:00.000+08:00
tags: 
- WIN32 API/MFC

categories:
- 舊部落格移植文章
---

# MFC用在Excel（載入Class篇）

原文連結: https://darkblack01.blogspot.com/2010/11/mfcexcelclass.html
移植時的最後更新日期: 2014-03-03T15:33:23.596+08:00

<br />以VC++ 6為例<br /><br />Add Class→From type library→Excel.exe<br />（沒看錯！要用.exe檔來載入Excel的Class，Office系列都這樣....吧？）<br /><br /><a name='more'></a><br /><b>載入的Class</b><br /><pre class="prettyprint"><code>_Application<br />_Chart<br />Sheets<br />_Worksheet<br />_Workbook<br />Workbooks<br />Font<br />Range<br />WorkSheets<br />ChartObject<br />ChartObjects<br />Interior<br />Shapes //繪統計圖<br />OLEFormat</code></pre><br />宣告也順便講一下好了！<br />以下是宣告的變數<br /><pre class="prettyprint"><code><br />COleVariant VOptional((long)DISP_E_PARAMNOTFOUND,VT_ERROR);<br />_Application objApp;  objApp.CreateDispatch("Excel.Application",&e)  //應用程式宣告<br /><br />Workbooks objBooks;   objBooks = objApp.GetWorkbooks();   //（在應用程式中）新增「 」 這種檔案<br />_Workbook objBook;    objBook = objBooks.Add(VOptional);  //活頁簿事件用變數<br /><br />Worksheets objSheets; objSheets = objBook.GetWorksheets();    //新增（活頁簿中的）「 」<br />_Worksheet objSheet; <br />           objSheet = objSheets.GetItem(COleVariant((short)1));  //工作表事件用變數<br />           <strike>objSheetT;</strike>  //忘了這是什麼了<br />    <br />Range  range,col,row;  range = objSheet.GetRange(COleVariant("C17"),COleVariant("C20"));  <br />                       //選取（工作表的）範圍 <br />       //,oCell;//,range2,range3; <br />Interior cell;  cell = range.GetInterior();  //設定（選取範圍的）儲存格 <br />Font font;      font = range.GetFont();      //設定（選取範圍的）字型 <br />COleException e;      （用法如下）             //錯誤訊息變數  //產生Excel <br /><br />if(!objApp.CreateDispatch("Excel.Application",&e))  //失敗<br />{<br />    CString str;<br />    str.Format("Excel CreateDispatch() failed w/err 0x%08lx", e.m_sc),<br />    AfxMessageBox(str, MB_SETFOREGROUND);<br />    return;<br />} </code></pre>
