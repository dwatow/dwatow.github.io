---
title: Code Complete II《軟體建構之道 2》#15 讀書心得與整理
date: 2013-05-24T14:34:00.003+08:00
tags: 
- Code Complete 2

categories:
- 舊部落格移植文章
---

# Code Complete II《軟體建構之道 2》#15 讀書心得與整理

原文連結: https://darkblack01.blogspot.com/2013/05/code-complete-ii-215.html
移植時的最後更新日期: 2013-07-16T09:56:00.604+08:00

<h2><span style="font-size: x-large;">第十五章 使用條列式<br />Using Conditionals</span></h2><h3><span style="font-size: large;">15.1 if陳述式<br />if Statements</span></h3><br /><h4>簡單if-then陳述式(if &amp; if-else)<br />Plain if-then Statements</h4><pre class="prettyprint"><code class="language-cpp">if (Expression)<br />{<br />    //Statement<br />}<br />else<br />{<br />    //Statement<br />}</code></pre><ul><b>先寫一般路徑的程式，再寫非一般的情況 </b><ul><pre class="prettyprint"><code class="language-cpp">if(運算式)<br />    一般路徑<br />else<br />    非一般路徑</code></pre></ul><b>慎用等號</b><br /><ol><li>用'&gt;'取代'&gt;='</li><li>用'&lt;'取代'&lt;='</li><li><span style="color: #3d85c6;">用'&gt;'和'&lt;'的範圍取代'=='</span></li></ol><ul>比較不會出現Off by one的錯誤</ul><ul><pre class="prettyprint"><code class="language-cpp">if(b == B)</code></pre>改成 <pre class="prettyprint"><code class="language-cpp">if(b &gt; A &amp;&amp; b &lt; c)</code></pre>比較好</ul><b>正常的情況放在if這一句，而不是else這一句</b><br /><ul><pre class="prettyprint"><code class="language-cpp">if(判斷A){<br />    例外A----------------x<br />}else{<br />    正常A----------------o<br />    if (判斷B){<br />        正常B------------o<br />        if (判斷C){<br />            例外C--------x<br />        else<br />            正常C--------o<br />    }else<br />        例外B------------x<br />}</code></pre>改成下面這樣比較好 <pre class="prettyprint"><code class="language-cpp">if(判斷A){<br />    正常A----------------o<br />    if (判斷B){<br />        正常B------------o<br />        if (判斷C){<br />            正常C--------o<br />        else<br />            例外C--------x<br />    }else<br />        例外B------------x<br />}else{<br />    例外A----------------x<br />}</code></pre></ul><b>有意義的陳述式放在if後面</b><br /><ul><pre class="prettyprint"><code class="language-cpp">if(someTest)<br />    ;<br />else<br />    doSomething();</code></pre>不如這樣寫來得好 <pre class="prettyprint"><code class="language-cpp">if(!someTest)<br />    doSomething();</code></pre></ul><b>寫if陳述式時，一併思考else陳述式</b><br /><ul>Sample code <pre class="prettyprint"><code class="language-cpp">if(!someTest)<br />    doSomething();<br />else<br />    //else doSomethingElse() is out of define<br />    //You can add assert(0) or not<br /></code></pre></ul><b>測試else的邏輯正確性</b><br /><ul>如果可以測試else務必測試</ul><b>檢查if和else的相反運算式</b><br /><ul>小心搞反了if的邏輯</ul></ul><br /><h4>連續if-then-else陳述式(if-else if)<br />Chains of if-then-else Statement</h4><pre class="prettyprint"><code class="language-cpp">if (Expression)<br />{<br />    //Statement<br />}<br />else if (Expression)<br />{<br />    //Statement<br />}<br />else<br />{<br />    //Statement<br />}</code></pre><ul><b>用回傳布林值的函數或運算式簡化複雜測試</b><ul>增加可讀性 <pre class="prettyprint"><code class="language-cpp">//C++ Example of an if-then-else Chain That Uses Boolan function Calls<br />      if ( IsControl( input Character ) ) {<br />    characterType = Chatactertype_ControlCharacter;<br />}else if ( IsPunctuation ( inputCharacter ) ) {<br />    characterType = ChatacterType_Punctuation;<br />}else if ( IsDigit ( inputCharacter ) ) {<br />    characterType = ChatacterType_Digit;<br />}else if ( IsLetter ( inputCharacter  ) ) {<br />    characterType = ChatacterType_Letter;<br />}</code></pre></ul><b>把最常見案例放在前面</b><br /><ul>增加可讀性，減少判斷的次數，提高效率 <pre class="prettyprint"><code class="language-cpp">if ( ... ) {<br />    //最常見<br />}else if ( ... ) {<br />    //次常見<br />}else if ( ... ) {<br />    //不常見<br />}</code></pre></ul><b>確定已包含所有案例</b><ul>else用來產生不應該發生的錯誤訊息 <pre class="prettyprint"><code class="language-cpp">//一個只有三種情況的範例，其它情況為「不該發生的情況」<br />if ( 是否為情況一 ) {<br />    //情況一<br />}else if ( 是否為情況二 ) {<br />    //情況二<br />}else if ( 是否為情況三 ) {<br />    //情況三<br />}else{<br />    //不該發生的情況<br />    //用assert(0) hight-light<br />}</code></pre></ul><b>如果你的語言支援，把if-else改成其它的語法</b><br /><ul>優點：更好撰寫、提昇可讀性</ul></ul><br /><br /><h3><span style="font-size: large;">15.2 case陳述式<br />case Statement</span></h3><pre class="prettyprint"><code class="language-cpp">switch (Expression)<br />{<br />    case 1:<br />        //Statement<br />        break;<br />    case 2:<br />        //Statement<br />        break;<br />    default:<br />        //Statement<br />}</code></pre><h4>選擇有效的case排序<br />Choosing the Most Effective Order of Case</h4><ol><li><b>依字母或數字順序(A~Z, 0~9)</b></li><li><b>先置入正常，再置入例外(正常~例外)</b></li><li><b>先置入常見，再置入不常見(常見~不常見)</b></li></ol><br /><h4>使用case陳述式的秘訣<br />Tips for Using case Statements</h4><ul><b>簡化每個案例動作 </b><ol><li>簡短程式碼</li><li>呼叫常式</li></ol><b>不要為了使用case而刻意創造「特殊的判斷方式」（phony variables） </b><ul>判斷無法快速擴充，當要擴充時必須重新寫整段，並且測試。等於重新設計整段程式碼。</ul><b>只使用default案例偵測唯一案例</b><br /><ul>正確的使用default的話，新增案例，只是小事一樁<br />不正確的使用default的話，要把default案例裡的code移走之類的... </ul><b>使用default偵測錯誤 </b><ul>default的用法： 將「根本不該發生」的情況放在default，在除錯時，這一個方式非常有用。 </ul><ul>不使用default偵測錯誤，隱喻了每一個案例都是正確的。請務必檢查輸入的值是否正確。</ul><b>在C++和Java中避免case程式碼最後接著下一個case </b><ul>程式會繼續往下一個案例執行，直到最後一個案例或者遇到break;或return<br />使用break; 或者 return xxx;來做case的結尾</ul><b>在C++中，case程式允許緊接著下一個caes預必加註解 </b><ul>如果，在你的設計，就是要讓這個案例執行完，接著下一個案例執行，或者這兩個案例有共同的程式段，必須這麼做。請加註解說明，以免接手的程式設計師以為這是你犯的錯誤。</ul></ul>
