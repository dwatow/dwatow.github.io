---
title: "Javascript 的二值化演算法"
date: 2017-05-07T10:11:00.001+08:00
tags: 
- "影像處理"
- "網頁前端技術"
- "javascript"
categories:
- 舊部落格移植文章
---

# Javascript 的二值化演算法

原文連結: https://darkblack02.blogspot.com/2017/05/javascript.html
移植時的最後更新日期: 2017-05-07T10:12:29.494+08:00

影像處理一直是寫程式的一個口袋題目，不管是做<a href="https://darkblack02.blogspot.tw/2011/05/rawsmooth.html" target="_blank">smooth演算法</a>，還是更簡單的<a href="https://darkblack02.blogspot.tw/2016/04/python-bitmap.html" target="_blank">取pixel值</a>，在這個部落格都各別以C++和python實現過了。<br /><br />最近，受朋友所託寫一個影像處理的小程式，是用來做二值化的演算法，其中的寫法是用原生的Javascript寫的，無需加任何的library即可執行。<br /><br />完整版的程式放在<a href="https://github.com/dwatow/ImageBinarization" target="_blank">github</a>上面<br /><br /><h3><span style="font-size: large;">主程式</span></h3><pre class="prettyprint"><code class="language-javascript">function main() {<br />      const canvas = document.querySelector("#draw");<br />      var ctx = canvas.getContext("2d");<br />      const height = img.height;<br />      const width = img.width;<br />      canvas.width = width;<br />      canvas.height = height;<br />      ctx.drawImage(img, 0, 0, width, height);<br />      let image = ctx.getImageData(0, 0, width, height);<br /><br />      threshold = threshold_input.value;<br />      image = imageProcess(image);<br /><br />      let [countW, countB] = countWB(image);<br />      showReport(countW, countB);<br /><br />      console.log(countW/(countW+countB)*100, countB/(countW+countB)*100);<br />      ctx.putImageData(image, 0, 0);<br />    }</code></pre><h3><span style="font-size: large;">演算法處理 </span></h3><pre class="prettyprint"><code class="language-javascript"> function imageProcess(frame) {<br />      for(let i = 0; i &lt; frame.data.length; i += 4) {<br />        let sum<br />          = frame.data[i + 0] +<br />            frame.data[i + 1] +<br />            frame.data[i + 2];<br /><br />        let color = sum / 3;<br /><br />        if (color &gt; threshold) {<br />          color = 255;<br />        }<br />        else {<br />          color = 0;<br />        }<br /><br />        frame.data[i + 0] = color; // RED<br />        frame.data[i + 1] = color; // GREEN<br />        frame.data[i + 2] = color; // Blue<br />      }<br />      return frame;<br />    }</code></pre><br /><h3><span style="font-size: large;">執行注意事項</span></h3>其中，<code>getImageData</code>語法，無法用瀏覽器透過<code>file://</code>讀取，所以在此建議使用<a href="https://darkblack02.blogspot.tw/search?updated-max=2017-04-29T10:37:00%2B08:00&amp;max-results=1" target="_blank">python的簡易web server</a>即可透過<code>localhost:8000</code>(預設用8000)成功取得影像資料。
