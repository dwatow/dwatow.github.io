---
title: "抱怨VC6//加了RichEdit，Dialog打不開"
date: 2013-03-27T13:49:00.002+08:00
tags: 
- "抱怨VC6"
categories:
- 舊部落格移植文章
---

# 抱怨VC6//加了RichEdit，Dialog打不開

原文連結: https://darkblack01.blogspot.com/2013/03/vc6richeditdialog.html
移植時的最後更新日期: 2013-03-27T13:50:07.719+08:00

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-a7UdVl4DAGk/UVKIYngcsTI/AAAAAAAAEpA/oRqeNUGRsy0/s1600/vcbugrichedit.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="316" src="http://1.bp.blogspot.com/-a7UdVl4DAGk/UVKIYngcsTI/AAAAAAAAEpA/oRqeNUGRsy0/s640/vcbugrichedit.png" width="640" /></a></div><br />想說，來練習一下CString的find()。<br /><br />從MS VC6，開一個MFC的Dialog Project。<br />用Static Text似乎不可以多行顯下，所以就新增一個Rich Edit來看看。<br />結果程式改成把字串輸出到Rich Edit就打不了？！<br /><br /><a name='more'></a><br /><br />（心想怎麼會這樣？）<br /><br />再來一次，在MS VC6，開一個MFC的Dialog Project，什麼程式碼都不要打。<br />直接執行→OK！<br />新增一個Rich Edit，再執行→NG！<br /><br />（囧）<br /><br />上網看了一下，要修改一下程式碼（如下） <br /><pre class="prettyprint"><code>BOOL CTempStrFindApp::InitInstance()<br />{<br />    <br />    CTempStrFindDlg dlg;<br />    m_pMainWnd = &amp;dlg;<br /><br />    AfxInitRichEdit();<br /><br />    dlg.DoModal();  //貼在這一行前面就可以了<br /><br />    return FALSE;<br />}</code></pre><br /><div style="color: #2a2a2a; line-height: 18px; padding-bottom: 15px;"><br /></div><div style="color: #2a2a2a; line-height: 18px; padding-bottom: 15px;">MSDN寫的如下 </div><div class="seeAlsoNoToggleSection" id="sectionSection0"><div class="alert" style="font-family: 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif; font-size: 11.818181991577148px; line-height: 14.545454025268555px;"><table style="border-collapse: collapse; border: 1px solid rgb(187, 187, 187); padding: 0px; width: 100%px;"><tbody><tr><th align="left" style="background-color: #ededed; border-collapse: collapse; border-spacing: 0px; border: 1px solid rgb(187, 187, 187); color: #707070; margin: 10px; padding: 10px 11px 5px;"><img alt="Note" class="note cl_IC101471" src="http://i.msdn.microsoft.com/areas/global/content/clear.gif" style="background-attachment: scroll; background-image: url(http://i3.msdn.microsoft.com/Areas/Epx/Content/Images/ImageSprite.png); background-position: -1152px -3px; background-repeat: no-repeat no-repeat; border: 0px; height: 14px; overflow: hidden; padding-right: 5px; width: 16px;" />Important</th></tr><tr><td style="border: 1px solid rgb(187, 187, 187); color: #2a2a2a; margin: 10px; padding: 10px 8px; vertical-align: top;"><div style="line-height: 18px; padding-bottom: 0px;">If you are using a rich edit control in a dialog box (regardless of whether your application is SDI, MDI, or dialog-based), you must call&nbsp;<a href="http://msdn.microsoft.com/zh-tw/library/tt1cfb9f(v=vs.80).aspx" style="color: #03697a; text-decoration: none;">AfxInitRichEdit</a>&nbsp;once before the dialog box is displayed. A typical place to call this function is in your program's&nbsp;<b>InitInstance</b>&nbsp;member function. You do not need to call it for each time you display the dialog box, only the first time. You do not have to call&nbsp;<b>AfxInitRichEdit</b>&nbsp;if you are working with&nbsp;<b>CRichEditView</b>.</div><div><br /></div></td></tr></tbody></table></div></div><br />參考資料：<a href="http://msdn.microsoft.com/zh-tw/library/bzhya91s(v=vs.80).aspx" target="_blank">Overview of the Rich Edit Control</a>
