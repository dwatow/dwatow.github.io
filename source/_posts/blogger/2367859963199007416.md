---
title: 不要再忘記的function pointer
date: 2014-12-06T22:33:00.001+08:00
tags: 
- C_and_Cpp

categories:
- 舊部落格移植文章
---

# 不要再忘記的function pointer

原文連結: https://darkblack01.blogspot.com/2014/12/function-pointer.html
移植時的最後更新日期: 2015-12-23T14:16:57.636+08:00

先貼上一段程式碼(參考自K&amp;R2 Ch5.11) <br /><pre class="prettyprint linenums:1"><code>#include &lt;stdio.h&gt;<br />  <br />typedef int (*returnInt)(void*, void*);<br />  <br />struct A<br />{<br />    returnInt comp;   <br />};<br /><br />int numcmp(char* s1, char* s2)<br />{<br />    double v1, v2;<br /><br />    v1 = atof(s1);<br />    v2 = atof(s2);<br /><br />    if (v1 &lt; v2)<br />        return -1;<br />    else<br />        return 0;<br />}<br /><br />int main()<br />{<br />    struct A a;<br />    a.comp = numcmp;<br /><br />    int o = a.comp("6", "5");<br />    printf("%d", o);<br /><br />    return 0;<br />}</code></pre>輸出結果： <br /><pre>0</pre><br />行3:用typedef來宣告函數指標(function pointer)，之後只要寫retutnInt，就算是寫整個函數指標，不用每一個地方都寫完整的函數指標宣告式。<br />function pointer的型別，包含它的返回值與參數列。<br />function pointer的名稱，就是...它的名稱。<br />用typedef的話，是另外取一個名稱代替它的型別，所以第7行才可以只寫名稱不寫完整的宣告式。<br /><br />行7:在struct A中，有一個函數指標(function pointer)，可以把它當作是c#的委派宣告。(因為函數的返回值與參數必須相同)<br />行26:指定要執行的function(在此尚未執行)<br />行28:使用方式，像C++的member function直覺。執行指定的function。
